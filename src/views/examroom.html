<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualización de Examen</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">

    <!-- Direccionamiento a hoja de estilos particular -->
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container mt-5">
        <div id="quizContainer"></div> <!-- Changed from <form> to <div> and ID corrected -->
        <div class="text-center">
            <button class="finalizar btn btn-primary" id="submit">Enviar</button>
        </div>

        <script>
            var CP = 0;
            //function to display quiz
            function displayExam(examData) {
                // Obtener el contenedor del examen
                const examContainer = document.getElementById('quizContainer');

                // Crear el título del tema
                const temaTitle = document.createElement('h2');
                temaTitle.textContent = `Tema: ${examData.botResponse.content.tema}`;
                examContainer.appendChild(temaTitle);

                // Crear las preguntas y opciones
                examData.botResponse.content.preguntas.forEach((pregunta, index) => {
                    const questionDiv = document.createElement('div');
                    questionDiv.classList.add('question');

                    const questionTitle = document.createElement('h3');
                    questionTitle.textContent = `Pregunta ${index + 1}: ${pregunta.enunciado}`;
                    questionDiv.appendChild(questionTitle);
                    CP++;
                    const optionsList = document.createElement('ul');
                    optionsList.classList.add('options');

                    pregunta.opciones.forEach(opcion => {
                        const optionItem = document.createElement('li');
                        optionItem.classList.add('option');

                        const optionLabel = document.createElement('label');
                        const optionInput = document.createElement('input');
                        optionInput.type = 'radio';
                        optionInput.name = `question${index}`;
                        optionInput.value = opcion;

                        optionLabel.appendChild(optionInput);
                        optionLabel.appendChild(document.createTextNode(opcion));

                        optionItem.appendChild(optionLabel);
                        optionsList.appendChild(optionItem);
                    });

                    questionDiv.appendChild(optionsList);
                    examContainer.appendChild(questionDiv);
                });

                const submitButton = document.getElementById('submit');
                submitButton.addEventListener('click', function () {
                    var puntaje = 0;
                    examData.botResponse.content.preguntas.forEach((pregunta, index) => {
                        const radios = document.getElementsByName(`question${index}`);
                        let respuestaSeleccionada;
                        radios.forEach(radio => {
                            if (radio.checked) {
                                respuestaSeleccionada = radio.value;
                            }
                        });
                        if (respuestaSeleccionada === pregunta.respuesta) {
                            puntaje += 1;
                        }
                    });
                    var calificacion = (puntaje * 10) / CP;
                    localStorage.setItem('calificacion', calificacion);
                    window.location.href = 'calificacion.html';
                    // alert(`Tu calificación es: ${calificacion}`);
                });

            };

            const examData = localStorage.getItem('examData');
            const parsedExam = JSON.parse(examData);
            displayExam(parsedExam);


        </script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>

</html>